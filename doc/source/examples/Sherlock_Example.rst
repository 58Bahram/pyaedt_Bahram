
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples\Sherlock_Example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_Sherlock_Example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_Sherlock_Example.py:


HFSS-Icepack Coupling Analysis
--------------------------------------------
This Example shows how to create an Icepak Project starting from Sherlock Files (step and csv) and aedb board 

.. GENERATED FROM PYTHON SOURCE LINES 7-25

.. code-block:: default




    import time
    import os
    import datetime
    import pathlib
    import sys

    local_path = os.path.abspath('')
    module_path = pathlib.Path(local_path)
    aedt_lib_path = module_path.parent
    sys.path.append(os.path.join(aedt_lib_path))
    from pyaedt import examples
    project_dir = examples.download_sherlock()










.. GENERATED FROM PYTHON SOURCE LINES 26-27

Input Variables

.. GENERATED FROM PYTHON SOURCE LINES 27-37

.. code-block:: default



    material_name = 'MaterialExport.csv'
    component_properties =  'TutorialBoardPartsList.csv'
    component_step = 'TutorialBoard.stp'
    aedt_odb_project = 'SherlockTutorial.aedt'
    aedt_odb_design_name = "PCB"
    stackup_thickness = 2.11836
    outline_polygon_name = "poly_14188"








.. GENERATED FROM PYTHON SOURCE LINES 38-40

Import pyaedt and start AEDT
AEDT will run in nongraphical mode

.. GENERATED FROM PYTHON SOURCE LINES 40-52

.. code-block:: default


    from pyaedt import Icepak
    from pyaedt import Desktop
    d=Desktop("2021.1", NG=False)
    start = time.time()
    material_list = os.path.join(project_dir, material_name)
    component_list = os.path.join(project_dir, component_properties)
    validation=os.path.join(project_dir, "validation.log")
    file_path=os.path.join(project_dir, component_step)
    project_name=os.path.join(project_dir, component_step[:-3]+"aedt")






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Using Windows TaskManager to Load processes
    Info: Ansoft.ElectronicsDesktop.2021.1 Started with Process ID 4400
    Info: pyaedt v0.5.0 started
    Info: Started external COM connection with module pythonnet_v3
    Info: Python version 3.8.5 (default, Sep  3 2020, 21:29:08) [MSC v.1916 64 bit (AMD64)]
    Info: Exe path: C:\Anaconda3\python.exe




.. GENERATED FROM PYTHON SOURCE LINES 53-54

Create an Icepak project and delete Region to improve performances

.. GENERATED FROM PYTHON SOURCE LINES 54-62

.. code-block:: default



    ipk = Icepak()
    # Removing region and disabling autosave to speedup import
    d.disable_autosave()
    ipk.modeler.primitives.delete("Region")
    component_name = "from_ODB"





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Warning: No design present - inserting a new design
    Info: Added design 'Icepak_S4H' of type Icepak
    Info: Design Loaded
    Info: Successfully loaded project materials !
    Info: Materials Loaded
    Info: Deleted 1 Objects




.. GENERATED FROM PYTHON SOURCE LINES 63-64

Import PCB from aedb file

.. GENERATED FROM PYTHON SOURCE LINES 64-70

.. code-block:: default



    odb_path = os.path.join(project_dir, aedt_odb_project)
    ipk.create_pcb_from_3dlayout(component_name, odb_path, aedt_odb_design_name,extenttype="Polygon",
                                   outlinepolygon=outline_polygon_name)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Closing the specified SherlockTutorial AEDT Project
    Info: PCB Component Correctly created in Icepak

    True



.. GENERATED FROM PYTHON SOURCE LINES 71-72

create an offset Coordinate system to match odb++ with sherlock step file

.. GENERATED FROM PYTHON SOURCE LINES 72-76

.. code-block:: default



    ipk.modeler.coordinate_system.create([0,0,stackup_thickness/2],view="XY")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <pyaedt.modeler.Modeler.CoordinateSystem object at 0x0000021DF37C8370>



.. GENERATED FROM PYTHON SOURCE LINES 77-78

import cad

.. GENERATED FROM PYTHON SOURCE LINES 78-84

.. code-block:: default



    ipk.modeler.import_3d_cad(file_path, refresh_all_ids=False)
    #save cad and refresh properties from aedt file parsing
    ipk.save_project(project_name, refresh_obj_ids_after_save=True)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Step file C:\Users\mcapodif\AppData\Local\Temp\Example_TYAIAR\sherlock\TutorialBoard.stp imported
    Info: Saving Project148 Project

    True



.. GENERATED FROM PYTHON SOURCE LINES 85-86

removing pcb objects

.. GENERATED FROM PYTHON SOURCE LINES 86-90

.. code-block:: default



    ipk.modeler.primitives.delete_objects_containing("pcb", False)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Deleted 1 Objects
    Info: Deleted 1 objects

    True



.. GENERATED FROM PYTHON SOURCE LINES 91-92

Creating Region

.. GENERATED FROM PYTHON SOURCE LINES 92-96

.. code-block:: default



    ipk.modeler.create_air_region(*[20,20,300,20,20,300])





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    6



.. GENERATED FROM PYTHON SOURCE LINES 97-98

assigning Materials

.. GENERATED FROM PYTHON SOURCE LINES 98-103

.. code-block:: default




    ipk.assignmaterial_from_sherlock_files(component_list, material_list)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Adding New Material material to Project Library: alumina
    Info: Material added. Please edit it to update in Desktop
    Info: Assign Material alumina to object COMP_R1,COMP_R2,COMP_R3,COMP_R4,COMP_R5,COMP_R6,COMP_R7,COMP_R8,COMP_R9,COMP_R10,COMP_R11,COMP_R12,COMP_R13,COMP_R14,COMP_R15,COMP_R16,COMP_R17,COMP_R18,COMP_R19,COMP_R20,COMP_R21,COMP_R22,COMP_R23,COMP_R24,COMP_R25,...
    Info: Assign Material aluminum to object COMP_C21,COMP_C22,COMP_C23,COMP_C24,COMP_C25,COMP_C26,COMP_C27,COMP_C28,COMP_C29,COMP_C30
    Info: Adding New Material material to Project Library: bariumtitanate
    Info: Material added. Please edit it to update in Desktop
    Info: Assign Material bariumtitanate to object COMP_C11,COMP_C12,COMP_C13,COMP_C14,COMP_C15,COMP_C16,COMP_C17,COMP_C18,COMP_C19,COMP_C20
    Info: Assign Material copper to object COMP_J1
    Info: Adding New Material material to Project Library: epoxyencapsulant
    Info: Material added. Please edit it to update in Desktop
    Info: Assign Material epoxyencapsulant to object COMP_Q1,COMP_Q2,COMP_Q3,COMP_Q4,COMP_Q5,COMP_Q6,COMP_Q7,COMP_Q8,COMP_Q9,COMP_Q10,COMP_Q11,COMP_Q12,COMP_Q13,COMP_Q14,COMP_Q15,COMP_Q16,COMP_U1,COMP_U2,COMP_U3,COMP_U4,COMP_U5,COMP_U6,COMP_U7,COMP_U8,COMP_U11...
    Info: Adding New Material material to Project Library: laminate-bga
    Info: Material added. Please edit it to update in Desktop
    Info: DATASET laminate_bgamass_densityTH0 doesn't exists.
    Info: Property Data Set: laminate_bgamass_densityTH0
    Info: DATASET laminate_bgamass_densityTH0 doesn't exists.
    Info: DATASET laminate_bgayoungs_modulusTH0 doesn't exists.
    Info: Property Data Set: laminate_bgayoungs_modulusTH0
    Info: DATASET laminate_bgayoungs_modulusTH0 doesn't exists.
    Info: DATASET $laminate_bgamass_densityTH0 exists.
    Info: DATASET $laminate_bgayoungs_modulusTH0 exists.
    Info: Assign Material laminate-bga to object COMP_U9,COMP_U10
    Info: Assign Material tantalum to object COMP_C1,COMP_C2,COMP_C3,COMP_C4,COMP_C5,COMP_C6,COMP_C7,COMP_C8,COMP_C9,COMP_C10

    True



.. GENERATED FROM PYTHON SOURCE LINES 104-105

Deleting Object with no material Assignment

.. GENERATED FROM PYTHON SOURCE LINES 105-113

.. code-block:: default




    no_material_objs = ipk.modeler.primitives.get_objects_by_material("")
    ipk.modeler.primitives.delete(no_material_objs)
    #ipk.modeler.set_object_model_state(all_objs, False)
    ipk.save_project()





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Deleted 0 Objects
    Info: Saving TutorialBoard Project

    True



.. GENERATED FROM PYTHON SOURCE LINES 114-115

Assign Power to Component Blocks

.. GENERATED FROM PYTHON SOURCE LINES 115-121

.. code-block:: default



    all_objects = ipk.modeler.primitives.get_all_objects_names()
    # Assign Power blocks
    total_power = ipk.assign_block_from_sherlock_file(component_list)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Blocks inserted with total power 34.2000000000002W




.. GENERATED FROM PYTHON SOURCE LINES 122-123

Setup and Boundaries

.. GENERATED FROM PYTHON SOURCE LINES 123-135

.. code-block:: default



    ipk.mesh.automatic_mesh_pcb(4)

    setup1 = ipk.create_setup()
    setup1.props["Solution Initialization - Y Velocity"] =  "1m_per_sec"
    setup1.props["Radiation Model"] ="Discrete Ordinates Model"
    setup1.props["Include Gravity"] =True
    setup1.props["Secondary Gradient"] =True
    setup1.update()
    ipk.assign_openings(ipk.modeler.primitives.get_object_faces("Region"))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Face List boundary_faces created
    Info: Opening Assigned

    <pyaedt.modules.Boundary.BoundaryObject object at 0x0000021D80608EE0>



.. GENERATED FROM PYTHON SOURCE LINES 136-137

Check for intersection using Validation and fix it by assigning Priorities

.. GENERATED FROM PYTHON SOURCE LINES 137-152

.. code-block:: default



    ipk.assign_priority_on_intersections()
    # Saving and closing
    ipk.save_project()


    end = time.time()-start
    ipk.close_desktop()
    print("Elapsed time: {}".format(datetime.timedelta(seconds=end)))
    print("Project Saved in {} ".format(project_dir))








.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Info: Saving TutorialBoard Project
    0 Intersections have been found. Applying Priorities
    Info: Saving TutorialBoard Project
    Elapsed time: 0:04:36.108799
    Project Saved in C:\Users\mcapodif\AppData\Local\Temp\Example_TYAIAR\sherlock 





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  37.775 seconds)


.. _sphx_glr_download_examples_Sherlock_Example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: Sherlock_Example.py <Sherlock_Example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: Sherlock_Example.ipynb <Sherlock_Example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
